<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prisme - Menu Digital</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .category-pill { white-space: nowrap; transition: all 0.3s; }
        .category-pill.active { background-color: #F39C12; color: white; }
        .whatsapp-btn { box-shadow: 0 4px 12px rgba(37, 211, 102, 0.4); }
    </style>
</head>
<body class="bg-gray-50 pb-24">

    <div class="relative h-48 w-full bg-cover bg-center" style="background-image: url('https://images.unsplash.com/photo-1504674900247-0877df9cc836?auto=format&fit=crop&w=800&q=80');">
        <div class="absolute inset-0 bg-black/30"></div>
    </div>

    <div class="px-4 -mt-12 relative z-10">
        <div class="bg-white rounded-2xl p-4 shadow-lg flex items-start space-x-4">
            <img id="restau-logo" src="" class="w-20 h-20 rounded-xl border-4 border-white shadow-md object-cover bg-white">
            <div class="pt-2">
                <h1 id="restau-nom" class="text-xl font-bold text-gray-800">Chargement...</h1>
                <p id="restau-addr" class="text-sm text-gray-500"><i class="fas fa-map-marker-alt mr-1"></i> Haïti</p>
            </div>
        </div>
    </div>

    <div class="flex overflow-x-auto space-x-2 px-4 py-6 no-scrollbar">
        <button class="category-pill active px-6 py-2 rounded-full border border-gray-200 bg-white text-gray-600 font-medium shadow-sm">Tout</button>
        <button class="category-pill px-6 py-2 rounded-full border border-gray-200 bg-white text-gray-600 font-medium shadow-sm">Entrées</button>
        <button class="category-pill px-6 py-2 rounded-full border border-gray-200 bg-white text-gray-600 font-medium shadow-sm">Plats</button>
        <button class="category-pill px-6 py-2 rounded-full border border-gray-200 bg-white text-gray-600 font-medium shadow-sm">Boissons</button>
    </div>

    <div class="px-4 space-y-6">
        <h2 id="current-category" class="text-lg font-bold text-gray-800 border-l-4 border-orange-500 pl-3">Tous les plats</h2>
        <div id="menu-list" class="grid grid-cols-1 md:grid-cols-2 gap-4">
            </div>
    </div>

    <a id="whatsapp-link" href="#" class="whatsapp-btn fixed bottom-6 right-6 bg-[#25D366] text-white px-6 py-3 rounded-full flex items-center space-x-2 font-bold z-50">
        <i class="fab fa-whatsapp text-2xl"></i>
        <span>WhatsApp</span>
    </a>

    <div class="mt-12 p-8 text-center bg-white">
        <p class="text-sm text-gray-400">Propulsé par <span class="font-bold text-orange-500">Prisme</span></p>
    </div>

    <script>
        // METE CONFIG OU LA A
        const firebaseConfig = {
            apiKey: "AIza...",
            authDomain: "le-menu-20dd1.firebaseapp.com",
            databaseURL: "https://le-menu-20dd1-default-rtdb.firebaseio.com",
            projectId: "le-menu-20dd1",
            storageBucket: "le-menu-20dd1.appspot.com",
            messagingSenderId: "...",
            appId: "..."
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        const urlParams = new URLSearchParams(window.location.search);
        const resID = urlParams.get('id') || 'lakay_gourmet_id';

        // 1. Rale Enfòmasyon Restoran
        db.ref('restaurants/' + resID + '/info').on('value', (snap) => {
            const info = snap.val();
            if(info) {
                document.getElementById('restau-nom').innerText = info.nom;
                document.getElementById('restau-logo').src = info.logoUrl;
                document.getElementById('whatsapp-link').href = `https://wa.me/${info.phone}?text=Bonjour ${info.nom}, je voudrais commander...`;
            }
        });

        // 2. Rale Menu an ak bèl Design (jan sa parèt nan Lakay Gourmet)
        db.ref('restaurants/' + resID + '/menu').on('value', (snap) => {
            const menuList = document.getElementById('menu-list');
            menuList.innerHTML = "";
            snap.forEach((child) => {
                const item = child.val();
                menuList.innerHTML += `
                    <div class="bg-white rounded-2xl shadow-sm border border-gray-100 flex overflow-hidden">
                        <img src="${item.imageUrl || 'https://via.placeholder.com/150'}" class="w-32 h-32 object-cover">
                        <div class="p-4 flex-1 flex flex-col justify-between">
                            <div>
                                <h3 class="font-bold text-gray-800">${item.nom}</h3>
                                <p class="text-xs text-gray-400 mt-1 line-clamp-2">${item.description || ''}</p>
                            </div>
                            <div class="text-[#F39C12] font-bold mt-2">${item.prix}</div>
                        </div>
                    </div>
                `;
            });
        });
    </script>
</body>
</html>
